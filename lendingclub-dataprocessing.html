<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns#">
	<head>
		<link href="http://gmpg.org/xfn/11" rel="profile">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta http-equiv="content-type" content="text/html; charset=utf-8">

		<!-- Metadata -->
	<meta name="description" content="Curious and passionate lady Rachel Wu">
	<meta property="og:description" content="Curious and passionate lady Rachel Wu">
	<meta property="og:title" content="LendingClub Data Analysis - Data Processing" />
	<meta property="og:type" content="article" />
	<meta property="og:url" content="./lendingclub-dataprocessing.html" />
		<meta property="og:image" content="./images/profile.JPG" />

		<!-- Enable responsiveness on mobile devices-->
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

		<title>Data Storyteller</title>

		<!-- CSS -->
		<link href="//fonts.googleapis.com/" rel="dns-prefetch">
		<link href="//fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic|Abril+Fatface|PT+Sans:400,400italic,700&amp;subset=latin,latin-ext" rel="stylesheet">

		<link rel="stylesheet" href="./theme/css/poole.css" />
		<link rel="stylesheet" href="./theme/css/hyde.css" />
		<link rel="stylesheet" href="./theme/css/syntax.css" />
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">

		<!-- RSS -->
		<link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
	</head>

	<body class="theme-base-0e">
<div class="sidebar">
	<div class="container sidebar-sticky">
		<div class="sidebar-about">

			<h1>
				<a href="https://tongkewu.github.io/DataSciencePortfolio"> 
					<img class="profile-picture" src="./images/profile.JPG">
					Data Storyteller
				</a>
			</h1>
			<p class="lead"></p>
			<p class="lead">Curious and passionate lady Rachel Wu </p>
			<p></p>
		</div>
		<nav class="sidebar-nav">
					<a class="sidebar-nav-item" href="https://www.linkedin.com/in/tongke-wu/">
						<i class="fa fa-linkedin"></i>
					</a>
					<a class="sidebar-nav-item" href="https://github.com/tongkewu">
						<i class="fa fa-github"></i>
					</a>
					<a class="sidebar-nav-item" href="mailto:wtkekeke910@gmail.com">
						<i class="fa fa-envelope"></i>
					</a>
			<a class="sidebar-nav-item" href="">
				<i class="fa fa-feed"></i>
			</a>
		</nav>
	</div>
</div>		<div class="content container">
<div class="post">
	<h1 class="post-title">LendingClub Data Analysis - Data Processing</h1>
	<span class="post-date">Mon 07 May 2018</span>
	<style type="text/css">/*!
*
* IPython notebook
*
*/
/* CSS font colors for translated ANSI colors. */
.ansibold {
  font-weight: bold;
}
/* use dark versions for foreground, to improve visibility */
.ansiblack {
  color: black;
}
.ansired {
  color: darkred;
}
.ansigreen {
  color: darkgreen;
}
.ansiyellow {
  color: #c4a000;
}
.ansiblue {
  color: darkblue;
}
.ansipurple {
  color: darkviolet;
}
.ansicyan {
  color: steelblue;
}
.ansigray {
  color: gray;
}
/* and light for background, for the same reason */
.ansibgblack {
  background-color: black;
}
.ansibgred {
  background-color: red;
}
.ansibggreen {
  background-color: green;
}
.ansibgyellow {
  background-color: yellow;
}
.ansibgblue {
  background-color: blue;
}
.ansibgpurple {
  background-color: magenta;
}
.ansibgcyan {
  background-color: cyan;
}
.ansibggray {
  background-color: gray;
}
div.cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  border-radius: 2px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  border-width: 1px;
  border-style: solid;
  border-color: transparent;
  width: 100%;
  padding: 5px;
  /* This acts as a spacer between cells, that is outside the border */
  margin: 0px;
  outline: none;
  border-left-width: 1px;
  padding-left: 5px;
  background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%);
}
div.cell.jupyter-soft-selected {
  border-left-color: #90CAF9;
  border-left-color: #E3F2FD;
  border-left-width: 1px;
  padding-left: 5px;
  border-right-color: #E3F2FD;
  border-right-width: 1px;
  background: #E3F2FD;
}
@media print {
  div.cell.jupyter-soft-selected {
    border-color: transparent;
  }
}
div.cell.selected {
  border-color: #ababab;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 5px, transparent 5px, transparent 100%);
}
@media print {
  div.cell.selected {
    border-color: transparent;
  }
}
div.cell.selected.jupyter-soft-selected {
  border-left-width: 0;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 7px, #E3F2FD 7px, #E3F2FD 100%);
}
.edit_mode div.cell.selected {
  border-color: #66BB6A;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #66BB6A -40px, #66BB6A 5px, transparent 5px, transparent 100%);
}
@media print {
  .edit_mode div.cell.selected {
    border-color: transparent;
  }
}
.prompt {
  /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */
  min-width: 14ex;
  /* This padding is tuned to match the padding on the CodeMirror editor. */
  padding: 0.4em;
  margin: 0px;
  font-family: monospace;
  text-align: right;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
  /* Don't highlight prompt number selection */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  /* Use default cursor */
  cursor: default;
}
@media (max-width: 540px) {
  .prompt {
    text-align: left;
  }
}
div.inner_cell {
  min-width: 0;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_area {
  border: 1px solid #cfcfcf;
  border-radius: 2px;
  background: #f7f7f7;
  line-height: 1.21429em;
}
/* This is needed so that empty prompt areas can collapse to zero height when there
   is no content in the output_subarea and the prompt. The main purpose of this is
   to make sure that empty JavaScript output_subareas have no height. */
div.prompt:empty {
  padding-top: 0;
  padding-bottom: 0;
}
div.unrecognized_cell {
  padding: 5px 5px 5px 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.unrecognized_cell .inner_cell {
  border-radius: 2px;
  padding: 5px;
  font-weight: bold;
  color: red;
  border: 1px solid #cfcfcf;
  background: #eaeaea;
}
div.unrecognized_cell .inner_cell a {
  color: inherit;
  text-decoration: none;
}
div.unrecognized_cell .inner_cell a:hover {
  color: inherit;
  text-decoration: none;
}
@media (max-width: 540px) {
  div.unrecognized_cell > div.prompt {
    display: none;
  }
}
div.code_cell {
  /* avoid page breaking on code cells when printing */
}
@media print {
  div.code_cell {
    page-break-inside: avoid;
  }
}
/* any special styling for code cells that are currently running goes here */
div.input {
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.input {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_prompt {
  color: #303F9F;
  border-top: 1px solid transparent;
}
div.input_area > div.highlight {
  margin: 0.4em;
  border: none;
  padding: 0px;
  background-color: transparent;
}
div.input_area > div.highlight > pre {
  margin: 0px;
  border: none;
  padding: 0px;
  background-color: transparent;
}
/* The following gets added to the <head> if it is detected that the user has a
 * monospace font with inconsistent normal/bold/italic height.  See
 * notebookmain.js.  Such fonts will have keywords vertically offset with
 * respect to the rest of the text.  The user should select a better font.
 * See: https://github.com/ipython/ipython/issues/1503
 *
 * .CodeMirror span {
 *      vertical-align: bottom;
 * }
 */
.CodeMirror {
  line-height: 1.21429em;
  /* Changed from 1em to our global default */
  font-size: 14px;
  height: auto;
  /* Changed to auto to autogrow */
  background: none;
  /* Changed from white to allow our bg to show through */
}
.CodeMirror-scroll {
  /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
  /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
  overflow-y: hidden;
  overflow-x: auto;
}
.CodeMirror-lines {
  /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */
  /* we have set a different line-height and want this to scale with that. */
  padding: 0.4em;
}
.CodeMirror-linenumber {
  padding: 0 8px 0 4px;
}
.CodeMirror-gutters {
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.CodeMirror pre {
  /* In CM3 this went to 4px from 0 in CM2. We need the 0 value because of how we size */
  /* .CodeMirror-lines */
  padding: 0;
  border: 0;
  border-radius: 0;
}
/*

Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org>
Adapted from GitHub theme

*/
.highlight-base {
  color: #000;
}
.highlight-variable {
  color: #000;
}
.highlight-variable-2 {
  color: #1a1a1a;
}
.highlight-variable-3 {
  color: #333333;
}
.highlight-string {
  color: #BA2121;
}
.highlight-comment {
  color: #408080;
  font-style: italic;
}
.highlight-number {
  color: #080;
}
.highlight-atom {
  color: #88F;
}
.highlight-keyword {
  color: #008000;
  font-weight: bold;
}
.highlight-builtin {
  color: #008000;
}
.highlight-error {
  color: #f00;
}
.highlight-operator {
  color: #AA22FF;
  font-weight: bold;
}
.highlight-meta {
  color: #AA22FF;
}
/* previously not defined, copying from default codemirror */
.highlight-def {
  color: #00f;
}
.highlight-string-2 {
  color: #f50;
}
.highlight-qualifier {
  color: #555;
}
.highlight-bracket {
  color: #997;
}
.highlight-tag {
  color: #170;
}
.highlight-attribute {
  color: #00c;
}
.highlight-header {
  color: blue;
}
.highlight-quote {
  color: #090;
}
.highlight-link {
  color: #00c;
}
/* apply the same style to codemirror */
.cm-s-ipython span.cm-keyword {
  color: #008000;
  font-weight: bold;
}
.cm-s-ipython span.cm-atom {
  color: #88F;
}
.cm-s-ipython span.cm-number {
  color: #080;
}
.cm-s-ipython span.cm-def {
  color: #00f;
}
.cm-s-ipython span.cm-variable {
  color: #000;
}
.cm-s-ipython span.cm-operator {
  color: #AA22FF;
  font-weight: bold;
}
.cm-s-ipython span.cm-variable-2 {
  color: #1a1a1a;
}
.cm-s-ipython span.cm-variable-3 {
  color: #333333;
}
.cm-s-ipython span.cm-comment {
  color: #408080;
  font-style: italic;
}
.cm-s-ipython span.cm-string {
  color: #BA2121;
}
.cm-s-ipython span.cm-string-2 {
  color: #f50;
}
.cm-s-ipython span.cm-meta {
  color: #AA22FF;
}
.cm-s-ipython span.cm-qualifier {
  color: #555;
}
.cm-s-ipython span.cm-builtin {
  color: #008000;
}
.cm-s-ipython span.cm-bracket {
  color: #997;
}
.cm-s-ipython span.cm-tag {
  color: #170;
}
.cm-s-ipython span.cm-attribute {
  color: #00c;
}
.cm-s-ipython span.cm-header {
  color: blue;
}
.cm-s-ipython span.cm-quote {
  color: #090;
}
.cm-s-ipython span.cm-link {
  color: #00c;
}
.cm-s-ipython span.cm-error {
  color: #f00;
}
.cm-s-ipython span.cm-tab {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);
  background-position: right;
  background-repeat: no-repeat;
}
div.output_wrapper {
  /* this position must be relative to enable descendents to be absolute within it */
  position: relative;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  z-index: 1;
}
/* class for the output area when it should be height-limited */
div.output_scroll {
  /* ideally, this would be max-height, but FF barfs all over that */
  height: 24em;
  /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */
  width: 100%;
  overflow: auto;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  display: block;
}
/* output div while it is collapsed */
div.output_collapsed {
  margin: 0px;
  padding: 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
div.out_prompt_overlay {
  height: 100%;
  padding: 0px 0.4em;
  position: absolute;
  border-radius: 2px;
}
div.out_prompt_overlay:hover {
  /* use inner shadow to get border that is computed the same on WebKit/FF */
  -webkit-box-shadow: inset 0 0 1px #000;
  box-shadow: inset 0 0 1px #000;
  background: rgba(240, 240, 240, 0.5);
}
div.output_prompt {
  color: #D84315;
}
/* This class is the outer container of all output sections. */
div.output_area {
  padding: 0px;
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.output_area .MathJax_Display {
  text-align: left !important;
}
div.output_area 
div.output_area 
div.output_area img,
div.output_area svg {
  max-width: 100%;
  height: auto;
}
div.output_area img.unconfined,
div.output_area svg.unconfined {
  max-width: none;
}
/* This is needed to protect the pre formating from global settings such
   as that of bootstrap */
.output {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.output_area {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
div.output_area pre {
  margin: 0;
  padding: 0;
  border: 0;
  vertical-align: baseline;
  color: black;
  background-color: transparent;
  border-radius: 0;
}
/* This class is for the output subarea inside the output_area and after
   the prompt div. */
div.output_subarea {
  overflow-x: auto;
  padding: 0.4em;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
  max-width: calc(100% - 14ex);
}
div.output_scroll div.output_subarea {
  overflow-x: visible;
}
/* The rest of the output_* classes are for special styling of the different
   output types */
/* all text output has this class: */
div.output_text {
  text-align: left;
  color: #000;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
}
/* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */
div.output_stderr {
  background: #fdd;
  /* very light red background for stderr */
}
div.output_latex {
  text-align: left;
}
/* Empty output_javascript divs should have no height */
div.output_javascript:empty {
  padding: 0;
}
.js-error {
  color: darkred;
}
/* raw_input styles */
div.raw_input_container {
  line-height: 1.21429em;
  padding-top: 5px;
}
pre.raw_input_prompt {
  /* nothing needed here. */
}
input.raw_input {
  font-family: monospace;
  font-size: inherit;
  color: inherit;
  width: auto;
  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;
  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0em 0.25em;
  margin: 0em 0.25em;
}
input.raw_input:focus {
  box-shadow: none;
}
p.p-space {
  margin-bottom: 10px;
}
div.output_unrecognized {
  padding: 5px;
  font-weight: bold;
  color: red;
}
div.output_unrecognized a {
  color: inherit;
  text-decoration: none;
}
div.output_unrecognized a:hover {
  color: inherit;
  text-decoration: none;
}
.rendered_html {
  color: #000;
  /* any extras will just be numbers: */
}



.rendered_html :link {
  text-decoration: underline;
}
.rendered_html :visited {
  text-decoration: underline;
}






.rendered_html h1:first-child {
  margin-top: 0.538em;
}
.rendered_html h2:first-child {
  margin-top: 0.636em;
}
.rendered_html h3:first-child {
  margin-top: 0.777em;
}
.rendered_html h4:first-child {
  margin-top: 1em;
}
.rendered_html h5:first-child {
  margin-top: 1em;
}
.rendered_html h6:first-child {
  margin-top: 1em;
}








.rendered_html * + ul {
  margin-top: 1em;
}
.rendered_html * + ol {
  margin-top: 1em;
}


.rendered_html pre,



.rendered_html tr,
.rendered_html th,

.rendered_html td,


.rendered_html * + table {
  margin-top: 1em;
}

.rendered_html * + p {
  margin-top: 1em;
}

.rendered_html * + img {
  margin-top: 1em;
}
.rendered_html img,

.rendered_html img.unconfined,

div.text_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.text_cell > div.prompt {
    display: none;
  }
}
div.text_cell_render {
  /*font-family: "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;*/
  outline: none;
  resize: none;
  width: inherit;
  border-style: none;
  padding: 0.5em 0.5em 0.5em 0.4em;
  color: #000;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
a.anchor-link:link {
  text-decoration: none;
  padding: 0px 20px;
  visibility: hidden;
}
h1:hover .anchor-link,
h2:hover .anchor-link,
h3:hover .anchor-link,
h4:hover .anchor-link,
h5:hover .anchor-link,
h6:hover .anchor-link {
  visibility: visible;
}
.text_cell.rendered .input_area {
  display: none;
}
.text_cell.rendered 
.text_cell.unrendered .text_cell_render {
  display: none;
}
.cm-header-1,
.cm-header-2,
.cm-header-3,
.cm-header-4,
.cm-header-5,
.cm-header-6 {
  font-weight: bold;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.cm-header-1 {
  font-size: 185.7%;
}
.cm-header-2 {
  font-size: 157.1%;
}
.cm-header-3 {
  font-size: 128.6%;
}
.cm-header-4 {
  font-size: 110%;
}
.cm-header-5 {
  font-size: 100%;
  font-style: italic;
}
.cm-header-6 {
  font-size: 100%;
  font-style: italic;
}
</style>
<style type="text/css">.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style>
<style type="text/css">
/* Temporary definitions which will become obsolete with Notebook release 5.0 */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }
</style>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Data-Description">Data Description<a class="anchor-link" href="#Data-Description">¶</a></h2><p>There are two data sets on <a href="https://www.lendingclub.com/info/download-data.action"> LendingClub </a> website.</p>
<p><b>Loan Statistics</b>: panal data. These files contain complete loan data for all loans issued through the time period stated.</p>
<p><b>Payment Historical Data</b>: time series of payment and balance of loans.</p>
<p>To enrich the data set and keep the time information, we combined two data sets together and got features and payment history of 92431 loans.</p>
<table>
<thead><tr>
<th>period: Jan 2007 - Sep 2016</th>
</tr>
</thead>
<tbody>
<tr>
<td>Dataset</td>
<td># of loans</td>
<td># of features</td>
<td># of rows</td>
</tr>
<tr>
<td>Loan Stats</td>
<td>1646779</td>
<td>150</td>
<td>1646779</td>
</tr>
<tr>
<td>Payment History</td>
<td>134966</td>
<td>39</td>
<td>3790864</td>
</tr>
<tr>
<td>Combined</td>
<td>92431</td>
<td>164</td>
<td>2543732</td>
</tr>
</tbody>
</table>
<p>The problem we are intersted is to predict monthly loan status transition. In this data set, there are 8 kinds of status related to the loan: Current, Fully Paid, Issued, In Grace Period, Late(16-30 days), Late(31-120 days), Defualt, Charged off. Since we are more concerned about default and prepayment in the loan, we will relabel the loan status as Current, Prepaid, Late(1 month), Late(2 months), Late(3 months), Late(4 months), Default and Charged-off. The main objectives in this data cleaning process are to:</p>
<ol>
<li>check if the payment history time series make sense</li>
<li>relabel loan status</li>
<li>dispose missing values in features</li>
</ol>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [4]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">pickle</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data_raw</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'./Data/data_with_payment.csv'</span><span class="p">)</span>
<span class="n">data_raw</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>/Users/Rachel/anaconda/lib/python3.6/site-packages/IPython/core/interactiveshell.py:2717: DtypeWarning: Columns (33,63,73,143,144,145,148,149,150,153,159,160,161) have mixed types. Specify dtype option on import or set low_memory=False.
  interactivity=interactivity, compiler=compiler, result=result)
</pre>
</div>
</div>
<div class="output_area">
<div class="prompt output_prompt">Out[2]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>LOAN_ID</th>
<th>PBAL_BEG_PERIOD</th>
<th>PRNCP_PAID</th>
<th>INT_PAID</th>
<th>FEE_PAID</th>
<th>DUE_AMT</th>
<th>RECEIVED_AMT</th>
<th>RECEIVED_D</th>
<th>PERIOD_END_LSTAT</th>
<th>MONTH</th>
<th>...</th>
<th>hardship_payoff_balance_amount</th>
<th>hardship_last_payment_amount</th>
<th>disbursement_method</th>
<th>debt_settlement_flag</th>
<th>debt_settlement_flag_date</th>
<th>settlement_status</th>
<th>settlement_date</th>
<th>settlement_amount</th>
<th>settlement_percentage</th>
<th>settlement_term</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>55716</td>
<td>3500.000000</td>
<td>116.262500</td>
<td>72.887500</td>
<td>0.0</td>
<td>139.15</td>
<td>189.15</td>
<td>SEP2016</td>
<td>Current</td>
<td>SEP2016</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>Cash</td>
<td>N</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr>
<th>1</th>
<td>55716</td>
<td>3383.737500</td>
<td>68.301875</td>
<td>70.848125</td>
<td>0.0</td>
<td>139.15</td>
<td>139.15</td>
<td>OCT2016</td>
<td>Current</td>
<td>OCT2016</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>Cash</td>
<td>N</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr>
<th>2</th>
<td>55716</td>
<td>3315.435625</td>
<td>70.106053</td>
<td>69.043947</td>
<td>0.0</td>
<td>139.15</td>
<td>139.15</td>
<td>NOV2016</td>
<td>Current</td>
<td>NOV2016</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>Cash</td>
<td>N</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr>
<th>3</th>
<td>55716</td>
<td>3245.329572</td>
<td>71.566012</td>
<td>67.583988</td>
<td>0.0</td>
<td>139.15</td>
<td>139.15</td>
<td>DEC2016</td>
<td>Current</td>
<td>DEC2016</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>Cash</td>
<td>N</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr>
<th>4</th>
<td>55716</td>
<td>3173.763560</td>
<td>73.056374</td>
<td>66.093626</td>
<td>0.0</td>
<td>139.15</td>
<td>139.15</td>
<td>JAN2017</td>
<td>Current</td>
<td>JAN2017</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>Cash</td>
<td>N</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>
<p>5 rows × 165 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Relabel-Loan-Status">Relabel Loan Status<a class="anchor-link" href="#Relabel-Loan-Status">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [3]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data_all</span> <span class="o">=</span> <span class="n">data_raw</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [4]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># MOB(Months of Balance) is an important feature</span>
<span class="n">issue_d</span> <span class="o">=</span> <span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span><span class="s1">'%b-%Y'</span><span class="p">)</span> <span class="k">for</span> <span class="n">dt</span> <span class="ow">in</span> <span class="n">data_all</span><span class="p">[</span><span class="s1">'issue_d'</span><span class="p">]]</span>
<span class="n">month</span> <span class="o">=</span> <span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span><span class="s1">'%b%Y'</span><span class="p">)</span> <span class="k">for</span> <span class="n">dt</span> <span class="ow">in</span> <span class="n">data_all</span><span class="p">[</span><span class="s1">'MONTH'</span><span class="p">]]</span>
<span class="n">mob</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="k">if</span> <span class="p">(</span><span class="n">m</span><span class="o">-</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">days</span> <span class="o">==</span><span class="mi">28</span> <span class="ow">or</span> <span class="p">(</span><span class="n">m</span><span class="o">-</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">days</span> <span class="o">==</span><span class="mi">29</span> <span class="k">else</span> <span class="p">(</span><span class="n">m</span><span class="o">-</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">days</span><span class="o">//</span><span class="mi">30</span> <span class="k">for</span> <span class="n">m</span><span class="p">,</span><span class="n">i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">month</span><span class="p">,</span><span class="n">issue_d</span><span class="p">)]</span>
<span class="n">data_all</span><span class="p">[</span><span class="s1">'MOB'</span><span class="p">]</span> <span class="o">=</span> <span class="n">mob</span>
<span class="n">data_all</span> <span class="o">=</span> <span class="n">data_all</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'LOAN_ID'</span><span class="p">,</span> <span class="s1">'MOB'</span><span class="p">],</span> <span class="n">keep</span> <span class="o">=</span> <span class="s1">'first'</span><span class="p">)</span> <span class="c1"># remains 2528507</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [5]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 1. remove MOB = 0 since we focus on MONTHLY transition not the status within a month</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">data_all</span><span class="p">[</span><span class="n">data_all</span><span class="p">[</span><span class="s1">'MOB'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">index</span> <span class="c1"># 536 loans</span>
<span class="n">data_all</span> <span class="o">=</span> <span class="n">data_all</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [46]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 2. relabel</span>
<span class="k">def</span> <span class="nf">relabel</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>    
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">pmt_m</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s1">'DUE_AMT'</span><span class="p">]</span>
    <span class="c1">#print(df.loc[0, 'LOAN_ID'], pmt_m)</span>
    <span class="n">group</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">'DUE_AMT'</span><span class="p">]</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s1">'RECEIVED_AMT'</span><span class="p">])</span> <span class="o">/</span> <span class="n">pmt_m</span>
    <span class="n">idx1</span> <span class="o">=</span> <span class="n">group</span><span class="p">[(</span><span class="n">group</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">group</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)]</span><span class="o">.</span><span class="n">index</span>
    <span class="n">group</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="c1">#idx2 = group[(group &lt; 0) &amp; (group &gt; -1)].index</span>
    <span class="c1">#group.loc[idx2] = -1.0</span>
    <span class="n">label_group</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">g</span><span class="p">))</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">group</span><span class="p">]</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">'label_group'</span><span class="p">]</span> <span class="o">=</span> <span class="n">label_group</span>
    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">'LOAN_ID'</span><span class="p">,</span> <span class="s1">'MOB'</span><span class="p">,</span><span class="s1">'PERIOD_END_LSTAT'</span><span class="p">,</span><span class="s1">'DUE_AMT'</span><span class="p">,</span><span class="s1">'RECEIVED_AMT'</span><span class="p">,</span> <span class="s1">'label_group'</span><span class="p">]]</span>   

<span class="n">relabel_group</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data_all</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'LOAN_ID'</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">relabel</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
<span class="n">data_all</span> <span class="o">=</span> <span class="n">data_all</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s1">'LOAN_ID'</span><span class="p">,</span> <span class="s1">'MOB'</span><span class="p">])</span>
<span class="n">data_all</span><span class="p">[</span><span class="s1">'label_group'</span><span class="p">]</span> <span class="o">=</span> <span class="n">relabel_group</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s1">'LOAN_ID'</span><span class="p">,</span> <span class="s1">'MOB'</span><span class="p">])[</span><span class="s1">'label_group'</span><span class="p">]</span>
<span class="n">data_all</span> <span class="o">=</span> <span class="n">data_all</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [19]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">term</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">data_all</span><span class="p">[</span><span class="s1">'term'</span><span class="p">]]</span>
<span class="n">data_all</span><span class="p">[</span><span class="s1">'term'</span><span class="p">]</span> <span class="o">=</span> <span class="n">term</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [34]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">label_dict</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s1">'Current'</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s1">'Late (1 month)'</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s1">'Late (2 months)'</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="s1">'Late (3 months)'</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="s1">'Late (4 months)'</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [42]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data_all</span><span class="p">[</span><span class="s1">'loan_status_end'</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_all</span><span class="p">[</span><span class="s1">'PERIOD_END_LSTAT'</span><span class="p">]</span>
<span class="n">data_all</span><span class="p">[</span><span class="s1">'loan_status_end'</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[42]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>array(['Current', 'Late (16-30 days)', 'Late (31-120 days)', 'Default',
       'Charged Off', 'Fully Paid', 'In Grace Period'], dtype=object)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [47]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data_all</span><span class="p">[</span><span class="n">data_all</span><span class="p">[</span><span class="s1">'loan_status_end'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'In Grace Period'</span><span class="p">][</span><span class="s1">'label_group'</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[47]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>array([1, 0])</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [48]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">idx1</span> <span class="o">=</span> <span class="n">data_all</span><span class="p">[(</span><span class="n">data_all</span><span class="p">[</span><span class="s1">'loan_status_end'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'In Grace Period'</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data_all</span><span class="p">[</span><span class="s1">'label_group'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)]</span><span class="o">.</span><span class="n">index</span>
<span class="n">data_all</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx1</span><span class="p">,</span> <span class="s1">'loan_status_end'</span><span class="p">]</span> <span class="o">=</span> <span class="n">label_dict</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [49]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">idx2</span> <span class="o">=</span> <span class="n">data_all</span><span class="p">[(</span><span class="n">data_all</span><span class="p">[</span><span class="s1">'loan_status_end'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'In Grace Period'</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data_all</span><span class="p">[</span><span class="s1">'label_group'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="n">index</span>
<span class="n">data_all</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx2</span><span class="p">,</span> <span class="s1">'loan_status_end'</span><span class="p">]</span> <span class="o">=</span> <span class="n">label_dict</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [50]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data_all</span><span class="p">[</span><span class="s1">'loan_status_end'</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[50]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>array(['Current', 'Late (16-30 days)', 'Late (31-120 days)', 'Default',
       'Charged Off', 'Fully Paid', 'Late (1 month)'], dtype=object)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [51]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data_all</span><span class="p">[</span><span class="n">data_all</span><span class="p">[</span><span class="s1">'loan_status_end'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'Late (16-30 days)'</span><span class="p">][</span><span class="s1">'label_group'</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[51]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>array([  1,   0,  -8,  -1,  -4,  -5,  -6, -15, -27, -14, -11, -13, -24,
       -12,  -2, -32])</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [52]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">idx3</span> <span class="o">=</span> <span class="n">data_all</span><span class="p">[(</span><span class="n">data_all</span><span class="p">[</span><span class="s1">'loan_status_end'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'Late (16-30 days)'</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data_all</span><span class="p">[</span><span class="s1">'label_group'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)]</span><span class="o">.</span><span class="n">index</span>
<span class="n">data_all</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx3</span><span class="p">,</span> <span class="s1">'loan_status_end'</span><span class="p">]</span> <span class="o">=</span> <span class="n">label_dict</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [53]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">idx4</span> <span class="o">=</span> <span class="n">data_all</span><span class="p">[(</span><span class="n">data_all</span><span class="p">[</span><span class="s1">'loan_status_end'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'Late (16-30 days)'</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data_all</span><span class="p">[</span><span class="s1">'label_group'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="n">index</span>
<span class="n">data_all</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx4</span><span class="p">,</span> <span class="s1">'loan_status_end'</span><span class="p">]</span> <span class="o">=</span> <span class="n">label_dict</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [59]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">idx5</span> <span class="o">=</span> <span class="n">data_all</span><span class="p">[(</span><span class="n">data_all</span><span class="p">[</span><span class="s1">'loan_status_end'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'Late (16-30 days)'</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data_all</span><span class="p">[</span><span class="s1">'label_group'</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="n">index</span>
<span class="n">data_all</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx5</span><span class="p">,</span> <span class="s1">'loan_status_end'</span><span class="p">]</span> <span class="o">=</span> <span class="n">label_dict</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [62]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data_all</span><span class="p">[</span><span class="s1">'loan_status_end'</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[62]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>array(['Current', 'Late (1 month)', 'Late (31-120 days)', 'Default',
       'Charged Off', 'Fully Paid'], dtype=object)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [63]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data_all</span><span class="p">[</span><span class="n">data_all</span><span class="p">[</span><span class="s1">'loan_status_end'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'Late (31-120 days)'</span><span class="p">][</span><span class="s1">'label_group'</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[63]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>array([  1,   2,   3,   4,   0,   5,   6,   7,   8,   9,  10,  11,  12,
        13, -11,  14,  -9,  -1, -22, -20,  -3, -12, -13])</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [73]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">idx6</span> <span class="o">=</span> <span class="n">data_all</span><span class="p">[(</span><span class="n">data_all</span><span class="p">[</span><span class="s1">'loan_status_end'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'Late (31-120 days)'</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data_all</span><span class="p">[</span><span class="s1">'label_group'</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="n">index</span>
<span class="n">data_all</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx6</span><span class="p">,</span> <span class="s1">'loan_status_end'</span><span class="p">]</span> <span class="o">=</span> <span class="n">label_dict</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [74]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">idx7</span> <span class="o">=</span> <span class="n">data_all</span><span class="p">[(</span><span class="n">data_all</span><span class="p">[</span><span class="s1">'loan_status_end'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'Late (31-120 days)'</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data_all</span><span class="p">[</span><span class="s1">'label_group'</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">)]</span><span class="o">.</span><span class="n">index</span>
<span class="n">data_all</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx7</span><span class="p">,</span> <span class="s1">'loan_status_end'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'Default'</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [75]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">label_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">data_all</span><span class="p">[(</span><span class="n">data_all</span><span class="p">[</span><span class="s1">'loan_status_end'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'Late (31-120 days)'</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data_all</span><span class="p">[</span><span class="s1">'label_group'</span><span class="p">]</span> <span class="o">==</span> <span class="n">g</span><span class="p">)]</span><span class="o">.</span><span class="n">index</span>
    <span class="n">data_all</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="s1">'loan_status_end'</span><span class="p">]</span> <span class="o">=</span> <span class="n">label_dict</span><span class="p">[</span><span class="n">g</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [77]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data_all</span><span class="p">[</span><span class="s1">'loan_status_end'</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[77]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>array(['Current', 'Late (1 month)', 'Late (2 months)', 'Late (3 months)',
       'Default', 'Charged Off', 'Fully Paid', 'Late (4 months)'], dtype=object)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [79]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">idx8</span> <span class="o">=</span> <span class="n">data_all</span><span class="p">[(</span><span class="n">data_all</span><span class="p">[</span><span class="s1">'loan_status_end'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'Fully Paid'</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data_all</span><span class="p">[</span><span class="s1">'MOB'</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">data_all</span><span class="p">[</span><span class="s1">'term'</span><span class="p">])]</span><span class="o">.</span><span class="n">index</span>
<span class="n">data_all</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx8</span><span class="p">,</span> <span class="s1">'loan_status_end'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'Prepaid'</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [80]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 3. remove loan_status_end = 'Fully Paid'</span>
<span class="n">idx9</span> <span class="o">=</span> <span class="n">data_all</span><span class="p">[</span><span class="n">data_all</span><span class="p">[</span><span class="s1">'loan_status_end'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'Fully Paid'</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
<span class="n">data_all</span> <span class="o">=</span> <span class="n">data_all</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">idx9</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [94]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">idx10</span> <span class="o">=</span> <span class="n">data_all</span><span class="p">[(</span><span class="n">data_all</span><span class="p">[</span><span class="s1">'loan_status_end'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'Prepaid'</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data_all</span><span class="p">[</span><span class="s1">'loan_status_bgn'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'Prepaid'</span><span class="p">)]</span><span class="o">.</span><span class="n">index</span>
<span class="n">data_all</span> <span class="o">=</span> <span class="n">data_all</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">idx10</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [95]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data_all</span><span class="p">[</span><span class="s1">'loan_status_end'</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[95]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>array(['Current', 'Late (1 month)', 'Late (2 months)', 'Late (3 months)',
       'Default', 'Charged Off', 'Prepaid', 'Late (4 months)'], dtype=object)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [82]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># beginning loan status</span>
<span class="k">def</span> <span class="nf">period_begin_lstat</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">sr</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">'Current'</span><span class="p">])</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">'loan_status_end'</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">sr</span>
<span class="n">loan_status_bgn</span> <span class="o">=</span> <span class="n">data_all</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'LOAN_ID'</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">period_begin_lstat</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">data_all</span><span class="p">[</span><span class="s1">'loan_status_bgn'</span><span class="p">]</span> <span class="o">=</span> <span class="n">loan_status_bgn</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [96]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">max_bytes</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="mi">31</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">bytes_out</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data_all</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'relabel_data.pl'</span><span class="p">,</span> <span class="s1">'wb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f_out</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">bytes_out</span><span class="p">),</span> <span class="n">max_bytes</span><span class="p">):</span>
        <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">bytes_out</span><span class="p">[</span><span class="n">idx</span><span class="p">:</span><span class="n">idx</span><span class="o">+</span><span class="n">max_bytes</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Check-Missing-Value">Check Missing Value<a class="anchor-link" href="#Check-Missing-Value">¶</a></h3><p>Now there are 168 columns in the combineng dataset. However, the data is not complete and we should check missing values first. Then we need to figure out why the data is missing and make adjustments. Meanwhile, we should remove useless data that can be either not informative or carrying the same information.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [5]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">os.path</span>
<span class="n">max_bytes</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="mi">31</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">file_path</span> <span class="o">=</span> <span class="s1">'relabel_data.pl'</span>
<span class="n">bytes_in</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">input_size</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s1">'rb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f_in</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">input_size</span><span class="p">,</span> <span class="n">max_bytes</span><span class="p">):</span>
        <span class="n">bytes_in</span> <span class="o">+=</span> <span class="n">f_in</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">max_bytes</span><span class="p">)</span>
<span class="n">data_all</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">bytes_in</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [6]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">msv</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">'missing_value'</span><span class="p">:</span><span class="n">data_all</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()})</span>
<span class="n">msv</span><span class="p">[</span><span class="s1">'percent'</span><span class="p">]</span> <span class="o">=</span> <span class="n">msv</span><span class="p">[</span><span class="s1">'missing_value'</span><span class="p">]</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">data_all</span><span class="p">)</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">msv</span><span class="p">[</span><span class="s1">'percent'</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s1">'hist'</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s1">'Hist of Percentage of Missing Values in Feature'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[6]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x11abe7d30&gt;</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
YII=
"/>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ol>
<li><p>100% Missing Data: There are 16 variables related to joint borrower/second applicant completely blank. It may because the joint loan program just launched at March 2017 and it's been a short time. Thus I dumped these variables.</p>
</li>
<li><p>99.96% Missing Data: There are 15 variables related to hardship plan only with one loan reacord. Thus I dropped them.</p>
</li>
<li><p>Consequential Data: 7 variables are related to settlement plan and are absent for 99.09%. Settlement is a plan for borrower who gets charged off. Therefore, only loans charged off keep this record. Since settlement is the consequence of charged off, data related to it should not be considered as feature that can classify loan status. Thus I dumped 7 features related to settlement.</p>
</li>
<li><p>Meaningless Data: including 'url', 'member_id', which are complete but not informative thus are dropped. And 'last_pymnt_d', 'last_pymnt_amt', 'next_pymnt_d' are removed since they have the same information as that of payment history data.</p>
</li>
</ol>
<p>After the above steps, there remains 122 columns in the data set. The next step is to format time data.</p>
<ol>
<li>Time Data: The aim is to convert time data to numerical data. One kind of variable like 'term' which has entry of ' 36 month' can be directly made number. The other kind of variables like 'issued_d' and 'MONTH' should be calculated and produce new feature like 'age of loan' to keep the time information from both variables.</li>
</ol>
<p>Then we should check the type of data and take strategy to deal with the rest of missing value that cannot be removed directly.</p>
<ol>
<li><p>Categorical Data: There are 19 categorical variables. However, some of them such as 'emp_title', 'desc' hold too many levels since they are text message. It will be great if NLP is employed to extract infromation from them to reduce the number of levels. Due to the time limit, I created dummy variables to simply indicate there is data point or not. For the rest of categorical variables, I added a level of 'missing' that represents missing value.</p>
</li>
<li><p>Continuous Data: For continuous variables, I created dummy variables to indicate whether the data is missing and filled in missing value with arbitrary number. It is a good idea to use an obviously out of range data.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [7]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">drop_cols_1</span> <span class="o">=</span> <span class="n">msv</span><span class="p">[</span><span class="n">msv</span><span class="p">[</span><span class="s1">'percent'</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="n">drop_cols_2</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'id'</span><span class="p">,</span> <span class="s1">'url'</span><span class="p">,</span> <span class="s1">'last_pymnt_d'</span><span class="p">,</span> <span class="s1">'last_pymnt_amnt'</span><span class="p">,</span> <span class="s1">'next_pymnt_d'</span><span class="p">,</span><span class="s1">'annual_inc_joint'</span><span class="p">,</span> <span class="s1">'dti_joint'</span><span class="p">,</span> <span class="s1">'verification_status_joint'</span><span class="p">]</span> <span class="c1"># 'member_id'</span>

<span class="n">drop_cols_3</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'hardship_flag'</span><span class="p">,</span><span class="s1">'hardship_type'</span><span class="p">,</span><span class="s1">'hardship_reason'</span><span class="p">,</span><span class="s1">'hardship_status'</span><span class="p">,</span>
               <span class="s1">'deferral_term'</span><span class="p">,</span><span class="s1">'hardship_amount'</span><span class="p">,</span><span class="s1">'hardship_start_date'</span><span class="p">,</span><span class="s1">'hardship_end_date'</span><span class="p">,</span>
               <span class="s1">'payment_plan_start_date'</span><span class="p">,</span><span class="s1">'hardship_length'</span><span class="p">,</span><span class="s1">'hardship_dpd'</span><span class="p">,</span><span class="s1">'hardship_loan_status'</span><span class="p">,</span>
               <span class="s1">'orig_projected_additional_accrued_interest'</span><span class="p">,</span><span class="s1">'hardship_payoff_balance_amount'</span><span class="p">,</span>
               <span class="s1">'hardship_last_payment_amount'</span><span class="p">]</span>
<span class="n">drop_cols_4</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'debt_settlement_flag'</span><span class="p">,</span><span class="s1">'debt_settlement_flag_date'</span><span class="p">,</span><span class="s1">'settlement_status'</span><span class="p">,</span>
               <span class="s1">'settlement_date'</span><span class="p">,</span><span class="s1">'settlement_amount'</span><span class="p">,</span><span class="s1">'settlement_percentage'</span><span class="p">,</span><span class="s1">'settlement_term'</span><span class="p">]</span>

<span class="n">loan_data</span> <span class="o">=</span> <span class="n">data_all</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">drop_cols_1</span> <span class="o">+</span> <span class="n">drop_cols_2</span> <span class="o">+</span> <span class="n">drop_cols_3</span> <span class="o">+</span> <span class="n">drop_cols_4</span><span class="p">,</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Format-Data">Format Data<a class="anchor-link" href="#Format-Data">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [9]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Format time data</span>
<span class="n">issue_d</span> <span class="o">=</span> <span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span><span class="s1">'%b-%Y'</span><span class="p">)</span> <span class="k">for</span> <span class="n">dt</span> <span class="ow">in</span> <span class="n">data_all</span><span class="p">[</span><span class="s1">'issue_d'</span><span class="p">]]</span>
<span class="n">earliest_cr_line</span> <span class="o">=</span> <span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span><span class="s1">'%b-%Y'</span><span class="p">)</span> <span class="k">for</span> <span class="n">dt</span> <span class="ow">in</span> <span class="n">loan_data</span><span class="p">[</span><span class="s1">'earliest_cr_line'</span><span class="p">]]</span>
<span class="n">RECEIVED_D</span> <span class="o">=</span> <span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span><span class="s1">'%b%Y'</span><span class="p">)</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span><span class="o">==</span><span class="nb">str</span> <span class="k">else</span> <span class="n">dt</span> <span class="k">for</span> <span class="n">dt</span> <span class="ow">in</span> <span class="n">loan_data</span><span class="p">[</span><span class="s1">'RECEIVED_D'</span><span class="p">]]</span>

<span class="n">ecl_cr_line_issue</span> <span class="o">=</span> <span class="p">[(</span><span class="n">i</span><span class="o">-</span><span class="n">e</span><span class="p">)</span><span class="o">.</span><span class="n">days</span><span class="o">//</span><span class="mi">30</span> <span class="k">for</span> <span class="n">e</span><span class="p">,</span><span class="n">i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">earliest_cr_line</span><span class="p">,</span><span class="n">issue_d</span><span class="p">)]</span>
<span class="n">receive_issue</span> <span class="o">=</span> <span class="p">[(</span><span class="n">r</span><span class="o">-</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">days</span><span class="o">//</span><span class="mi">30</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">!=</span><span class="nb">float</span> <span class="k">else</span> <span class="n">r</span> <span class="k">for</span> <span class="n">r</span><span class="p">,</span><span class="n">i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">RECEIVED_D</span><span class="p">,</span><span class="n">issue_d</span><span class="p">)]</span>
<span class="n">loan_data</span><span class="p">[</span><span class="s1">'ecl_cr_line_issue'</span><span class="p">]</span> <span class="o">=</span> <span class="n">ecl_cr_line_issue</span>
<span class="n">loan_data</span><span class="p">[</span><span class="s1">'receive_issue'</span><span class="p">]</span> <span class="o">=</span> <span class="n">receive_issue</span>

<span class="n">drop_cols_5</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'issue_d'</span><span class="p">,</span> <span class="s1">'MONTH'</span><span class="p">,</span><span class="s1">'last_credit_pull_d'</span><span class="p">,</span> <span class="s1">'earliest_cr_line'</span><span class="p">,</span> <span class="s1">'RECEIVED_D'</span><span class="p">]</span>
<span class="n">loan_data</span> <span class="o">=</span> <span class="n">loan_data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">drop_cols_5</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [10]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># convert str of percentage to float</span>
<span class="k">def</span> <span class="nf">str2float</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">col_name</span><span class="p">):</span>
    <span class="n">df</span><span class="p">[</span><span class="n">col_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">'%'</span><span class="p">))</span><span class="o">/</span><span class="mi">100</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">==</span><span class="nb">str</span> <span class="k">else</span> <span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="n">col_name</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>

<span class="n">str_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'revol_util'</span><span class="p">,</span> <span class="s1">'int_rate'</span><span class="p">]</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">str_cols</span><span class="p">:</span>
    <span class="n">str2float</span><span class="p">(</span><span class="n">loan_data</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>

<span class="n">loan_data</span><span class="p">[</span><span class="s1">'policy_code'</span><span class="p">]</span> <span class="o">=</span> <span class="n">loan_data</span><span class="p">[</span><span class="s1">'policy_code'</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'str'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [11]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">add_dummy_variable</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">col_name</span><span class="p">):</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col_name</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">col_name</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()]</span>
    <span class="n">dummy_col_name</span> <span class="o">=</span> <span class="n">col_name</span> <span class="o">+</span> <span class="s1">'_dummy'</span>
    <span class="n">df</span><span class="p">[</span><span class="n">dummy_col_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="n">dummy_col_name</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">'emp_title'</span><span class="p">,</span> <span class="s1">'desc'</span><span class="p">]:</span>
    <span class="n">add_dummy_variable</span><span class="p">(</span><span class="n">loan_data</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
    
<span class="n">loan_data</span> <span class="o">=</span> <span class="n">loan_data</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">'emp_title'</span><span class="p">,</span> <span class="s1">'desc'</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">dtype</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">loan_data</span><span class="o">.</span><span class="n">dtypes</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'dtype'</span><span class="p">])</span>
<span class="n">ls1</span> <span class="o">=</span> <span class="n">msv</span><span class="p">[</span><span class="n">msv</span><span class="p">[</span><span class="s1">'percent'</span><span class="p">]</span><span class="o">!=</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">ls2</span> <span class="o">=</span> <span class="n">dtype</span><span class="p">[</span><span class="n">dtype</span><span class="p">[</span><span class="s1">'dtype'</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">'object'</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">ls2</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">'LOAN_ID'</span><span class="p">)</span>
<span class="n">num_cols</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">ls1</span><span class="p">)</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">ls2</span><span class="p">))</span>

<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">num_cols</span><span class="p">:</span>
    <span class="n">add_dummy_variable</span><span class="p">(</span><span class="n">loan_data</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [12]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">add_missing_level</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">col_name</span><span class="p">):</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col_name</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">col_name</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()]</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="n">col_name</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'missing'</span>
    
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">'title'</span><span class="p">]:</span> <span class="c1"># 'emp_length'</span>
    <span class="n">add_missing_level</span><span class="p">(</span><span class="n">loan_data</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [13]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">loan_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[13]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>LOAN_ID</th>
<th>MOB</th>
<th>PBAL_BEG_PERIOD</th>
<th>PRNCP_PAID</th>
<th>INT_PAID</th>
<th>FEE_PAID</th>
<th>DUE_AMT</th>
<th>RECEIVED_AMT</th>
<th>PERIOD_END_LSTAT</th>
<th>PBAL_END_PERIOD</th>
<th>...</th>
<th>open_il_12m_dummy</th>
<th>open_rv_24m_dummy</th>
<th>open_il_24m_dummy</th>
<th>num_actv_bc_tl_dummy</th>
<th>total_bal_ex_mort_dummy</th>
<th>mths_since_recent_bc_dummy</th>
<th>mths_since_last_major_derog_dummy</th>
<th>num_sats_dummy</th>
<th>mths_since_rcnt_il_dummy</th>
<th>num_bc_tl_dummy</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>55716</td>
<td>1</td>
<td>3500.000000</td>
<td>116.262500</td>
<td>72.887500</td>
<td>0.0</td>
<td>139.15</td>
<td>189.15</td>
<td>Current</td>
<td>3383.737500</td>
<td>...</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<th>1</th>
<td>55716</td>
<td>2</td>
<td>3383.737500</td>
<td>68.301875</td>
<td>70.848125</td>
<td>0.0</td>
<td>139.15</td>
<td>139.15</td>
<td>Current</td>
<td>3315.435625</td>
<td>...</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<th>2</th>
<td>55716</td>
<td>3</td>
<td>3315.435625</td>
<td>70.106053</td>
<td>69.043947</td>
<td>0.0</td>
<td>139.15</td>
<td>139.15</td>
<td>Current</td>
<td>3245.329572</td>
<td>...</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<th>3</th>
<td>55716</td>
<td>4</td>
<td>3245.329572</td>
<td>71.566012</td>
<td>67.583988</td>
<td>0.0</td>
<td>139.15</td>
<td>139.15</td>
<td>Current</td>
<td>3173.763560</td>
<td>...</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<th>4</th>
<td>55716</td>
<td>5</td>
<td>3173.763560</td>
<td>73.056374</td>
<td>66.093626</td>
<td>0.0</td>
<td>139.15</td>
<td>139.15</td>
<td>Current</td>
<td>3100.707186</td>
<td>...</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>5 rows × 176 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [16]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bytes_out</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">loan_data</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'clean_data.pl'</span><span class="p">,</span> <span class="s1">'wb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f_out</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">bytes_out</span><span class="p">),</span> <span class="n">max_bytes</span><span class="p">):</span>
        <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">bytes_out</span><span class="p">[</span><span class="n">idx</span><span class="p">:</span><span class="n">idx</span><span class="o">+</span><span class="n">max_bytes</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>
</div>
</div>
</div>
</div>

<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        " linebreaks: { automatic: true, width: '95% container' }, " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>

</div>
		</div>
	</body>
</html>